<!DOCTYPE html>
<html>
	<head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js"></script>

		<script src="//treetopflyer.github.com/vcore/lib.js"></script>
        <script src="//treetopflyer.github.com/rasterizer/lib.js"></script>

        <script src="ngImportCSV.js"></script>
        <script src="rbm.js"></script>
        
	</head>
	<body>
        
        

        <img class="ts1 1_1" src="ts2_L_1.png"/>
        <img class="ts1 1_2" src="ts2_L_2.png"/>
        <img class="ts1 1_3" src="ts2_L_3.png"/>
        
        <img class="ts1 2_1" src="ts2_E_1.png"/>
        <img class="ts1 2_2" src="ts2_E_2.png"/>
        <img class="ts1 2_3" src="ts2_E_3.png"/>
        
        <img class="ts1 3_1" src="ts1_1_1.png"/>
        <img class="ts1 3_2" src="ts1_1_2.png"/>
        <img class="ts1 3_3" src="ts1_1_3.png"/>
        <img class="ts1 3_4" src="ts1_1_4.png"/>
        
        <img class="ts1 4_1" src="ts1_2_1.png"/>
        <img class="ts1 4_2" src="ts1_2_2.png"/>
        <img class="ts1 4_3" src="ts1_2_3.png"/>
        <img class="ts1 4_4" src="ts1_2_4.png"/>
        
        <br/>
        <br/>
        
        
        

        <div ng-app="DatApp" ng-controller="DatAppController">
            <canvas ng-bake="ts1_2_1.png" ng-callback="GetBytes"></canvas>
        </div>


<script>
var DatApp = angular.module("DatApp", ["ngImportCSV"]);
DatApp.directive("ngBake", ["$parse", function($parse)
{
    var obj = {};

    obj.link = function(inScope, inElement, inAttributes)
    {   
        var img;
        img = new Image();
        img.onload = function()
        {
            var canvas;
            var context;
            var setter;

            canvas = inElement[0];
            canvas.width = img.width;
            canvas.height = img.height;

            context = canvas.getContext('2d');
            context.drawImage(img, 0, 0);

            setter = $parse(inAttributes.ngCallback);
            setter(inScope)(context, canvas);
        };
        img.src = inAttributes.ngBake;
    };

    return obj;
}]);
DatApp.controller("DatAppController", ["$scope", function($scope)
{

    $scope.Clip = [15, 15];

    $scope.GetBytes = function(inContext, inCanvas)
    {
        var x, y;
        for(y=0; y<(inCanvas.height - $scope.Clip[1]); y+= $scope.Clip[1])
        {
            for(x=0; x<(inCanvas.width - $scope.Clip[0]); x+= $scope.Clip[0])
            {
                console.log(x, y, inContext.getImageData(x, y, $scope.Clip[0], $scope.Clip[1]));
            }
        }
    };

}]);
</script>

	</body>
</html>